{"version":3,"file":"contacts-files-action.mjs","sources":["../src/components/ConfirmationDialog.vue","../node_modules/@mdi/svg/svg/account-multiple.svg?raw","../src/files-action.js"],"sourcesContent":["<!--\n  - SPDX-FileCopyrightText: 2023 Nextcloud GmbH and Nextcloud contributors\n  - SPDX-License-Identifier: AGPL-3.0-or-later\n-->\n<template>\n\t<NcModal class=\"confirm-modal\" @close=\"cancel\">\n\t\t<div class=\"confirm-modal\">\n\t\t\t<h2>{{ title }}</h2>\n\t\t\t<slot />\n\t\t\t<div class=\"confirm-modal__buttons\">\n\t\t\t\t<NcButton type=\"tertiary\" :disabled=\"disabled\" @click=\"cancel\">\n\t\t\t\t\t{{ t('contacts', 'Cancel') }}\n\t\t\t\t</NcButton>\n\t\t\t\t<NcButton v-if=\"resolve\"\n\t\t\t\t\t:disabled=\"disabled\"\n\t\t\t\t\ttype=\"primary\"\n\t\t\t\t\t@click=\"confirm\">\n\t\t\t\t\t{{ confirmText }}\n\t\t\t\t</NcButton>\n\t\t\t</div>\n\t\t</div>\n\t</NcModal>\n</template>\n\n<script>\nimport { NcButton, NcModal } from '@nextcloud/vue'\nimport { translate as t } from '@nextcloud/l10n'\n\nexport default {\n\tname: 'ConfirmationDialog',\n\tcomponents: {\n\t\tNcButton,\n\t\tNcModal,\n\t},\n\tprops: {\n\t\ttitle: {\n\t\t\ttype: String,\n\t\t\trequired: true,\n\t\t},\n\t\tresolve: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\treject: {\n\t\t\ttype: Function,\n\t\t\trequired: true,\n\t\t},\n\t\tconfirmText: {\n\t\t\ttype: String,\n\t\t\tdefault: t('contacts', 'Confirm'),\n\t\t},\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: undefined,\n\t\t},\n\t},\n\tmethods: {\n\t\tconfirm() {\n\t\t\tthis.resolve()\n\t\t},\n\t\tcancel() {\n\t\t\tthis.reject()\n\t\t},\n\t},\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.confirm-modal {\n\tpadding: 20px;\n\n\t&__buttons {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t}\n}\n</style>\n","export default \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" id=\\\"mdi-account-multiple\\\" viewBox=\\\"0 0 24 24\\\"><path d=\\\"M16 17V19H2V17S2 13 9 13 16 17 16 17M12.5 7.5A3.5 3.5 0 1 0 9 11A3.5 3.5 0 0 0 12.5 7.5M15.94 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13M15 4A3.39 3.39 0 0 0 13.07 4.59A5 5 0 0 1 13.07 10.41A3.39 3.39 0 0 0 15 11A3.5 3.5 0 0 0 15 4Z\\\" /></svg>\"","/**\n * SPDX-FileCopyrightText: 2020 Nextcloud GmbH and Nextcloud contributors\n * SPDX-License-Identifier: AGPL-3.0-or-later\n */\n\n// eslint-disable-next-line import/no-unresolved, n/no-missing-import\nimport 'vite/modulepreload-polyfill'\n\nimport ConfirmationDialog from './components/ConfirmationDialog.vue'\n\nimport { generateUrl } from '@nextcloud/router'\nimport { translate as t } from '@nextcloud/l10n'\nimport { DefaultType, FileAction, Permission, registerFileAction } from '@nextcloud/files'\n/* eslint-disable-next-line import/no-unresolved */\nimport ContactSvg from '@mdi/svg/svg/account-multiple.svg?raw'\nimport Vue from 'vue'\n\nVue.prototype.t = t\n\nconst mime = 'text/vcard'\nconst name = 'contacts-import'\n\nregisterFileAction(new FileAction({\n\tid: name,\n\tdisplayName: () => t('contacts', 'Import'),\n\tdefault: DefaultType.DEFAULT,\n\tenabled: (nodes) => {\n\t\tif (nodes.length !== 1) {\n\t\t\treturn false\n\t\t}\n\t\tconst node = nodes[0]\n\t\treturn node.mime === mime && (node.permissions & Permission.READ)\n\t},\n\ticonSvgInline: () => ContactSvg,\n\tasync exec(file) {\n\t\tlet dialog\n\t\ttry {\n\t\t\t// Open the confirmation dialog\n\t\t\tconst containerId = 'confirmation-' + Math.random().toString(16).slice(2)\n\t\t\tconst container = document.createElement('div')\n\t\t\tcontainer.id = containerId\n\t\t\tdocument.body.appendChild(container)\n\t\t\tawait new Promise((resolve, reject) => {\n\t\t\t\tconst ImportConfirmationDialog = Vue.extend(ConfirmationDialog)\n\t\t\t\tdialog = new ImportConfirmationDialog({\n\t\t\t\t\tpropsData: {\n\t\t\t\t\t\ttitle: t('contacts', 'Are you sure you want to import this contact file?'),\n\t\t\t\t\t\tresolve,\n\t\t\t\t\t\treject,\n\t\t\t\t\t},\n\t\t\t\t})\n\t\t\t\tdialog.$mount(`#${containerId}`)\n\t\t\t})\n\n\t\t\t// Redirect to the import page if the user confirmed\n\t\t\twindow.location = generateUrl(`/apps/contacts/import?file=${file.path}`)\n\t\t} catch (e) {\n\t\t\t// Do nothing if the user cancels\n\t\t}\n\n\t\t// Destroy confirmation modal (div element is removed from the DOM by vue)\n\t\tdialog.$destroy()\n\t},\n}))\n"],"names":["_sfc_main","NcButton","NcModal","t","ContactSvg","Vue","mime","name","registerFileAction","FileAction","DefaultType","nodes","node","Permission","file","dialog","containerId","container","resolve","reject","ImportConfirmationDialog","ConfirmationDialog","generateUrl"],"mappings":";8LA4BA,MAAAA,EAAA,CACA,KAAA,qBACA,WAAA,CACA,SAAAC,EACA,QAAAC,CACA,EACA,MAAA,CACA,MAAA,CACA,KAAA,OACA,SAAA,EACA,EACA,QAAA,CACA,KAAA,SACA,SAAA,EACA,EACA,OAAA,CACA,KAAA,SACA,SAAA,EACA,EACA,YAAA,CACA,KAAA,OACA,QAAAC,EAAA,WAAA,SAAA,CACA,EACA,SAAA,CACA,KAAA,QACA,QAAA,MACA,CACA,EACA,QAAA,CACA,SAAA,CACA,KAAA,QAAA,CACA,EACA,QAAA,CACA,KAAA,OAAA,CACA,CACA,CACA,0jBChEeC,EAAA,6VCiBfC,EAAI,UAAU,EAAIF,EAElB,MAAMG,EAAO,aACPC,EAAO,kBAEbC,EAAmB,IAAIC,EAAW,CACjC,GAAIF,EACJ,YAAa,IAAMJ,EAAE,WAAY,QAAQ,EACzC,QAASO,EAAY,QACrB,QAAUC,GAAU,CACnB,GAAIA,EAAM,SAAW,EACpB,MAAO,GAER,MAAMC,EAAOD,EAAM,CAAC,EACpB,OAAOC,EAAK,OAASN,GAASM,EAAK,YAAcC,EAAW,IAC5D,EACD,cAAe,IAAMT,EACrB,MAAM,KAAKU,EAAM,CAChB,IAAIC,EACJ,GAAI,CAEH,MAAMC,EAAc,gBAAkB,KAAK,OAAQ,EAAC,SAAS,EAAE,EAAE,MAAM,CAAC,EAClEC,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,GAAKD,EACf,SAAS,KAAK,YAAYC,CAAS,EACnC,MAAM,IAAI,QAAQ,CAACC,EAASC,IAAW,CACtC,MAAMC,EAA2Bf,EAAI,OAAOgB,CAAkB,EAC9DN,EAAS,IAAIK,EAAyB,CACrC,UAAW,CACV,MAAOjB,EAAE,WAAY,oDAAoD,EACzE,QAAAe,EACA,OAAAC,CACA,CACD,CAAA,EACDJ,EAAO,OAAO,IAAIC,CAAW,EAAE,CAC/B,CAAA,EAGD,OAAO,SAAWM,EAAY,8BAA8BR,EAAK,IAAI,EAAE,CACvE,MAAW,CAEd,CAGEC,EAAO,SAAQ,CACf,CACF,CAAC,CAAC","x_google_ignoreList":[1]}